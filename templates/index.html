<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BaÃº de Receitas - Forja de Receitas Ã‰picas</title>
    <link rel="stylesheet" href="{{ url_for('static_files', filename='style.css') }}">
</head>
<body>
    <div class="main-container"> {# Add main-container class #}
        <h1>âš”ï¸ BaÃº de Receitas âš”ï¸</h1>
        <p>Bem-vindo ao BaÃº de Receitas! Entre na <strong>Forja de FÃ³rmulas Ã‰picas</strong>!</p>
        <p>Informe os ingredientes que vocÃª possui em seu inventÃ¡rio, e nossos Mestres CulinÃ¡rios Alquimistas conjurarÃ£o uma receita exclusiva para vocÃª.</p>
        <hr>

        <h2>ğŸ”¥ A Forja de FÃ³rmulas Ã‰picas ğŸ”¥</h2>

        <div class="input-area"> {# Optional: Add a class for input area if specific styling is needed #}
            <h3>ğŸ“œ Ingredientes em Seu InventÃ¡rio:</h3>
            <form method="POST">
                <textarea name="ingredients" rows="4" placeholder="Ex: casca de abÃ³bora, talo de brÃ³colis, pÃ£o amanhecido, cenoura murcha...">{{ ingredients }}</textarea>
                <button type="submit">âœ¨ FORJAR RECEITA! âœ¨</button>
            </form>
        </div>

        <div class="recipe-output-area"> {# Add recipe-output-area class #}
            <h3>ğŸ“– FÃ³rmula MÃ¡gica Revelada: ğŸ“–</h3>
            {% if error_message %}
                <div class="error-message">{{ error_message }}</div> {# Add error-message class #}
            {% elif rendered_recipe_html %} {# <--- Use a nova variÃ¡vel para o HTML renderizado #}
                <div class="recipe-content"> {# Add recipe-content class #}
                    {{ rendered_recipe_html | safe }} {# O | safe ainda Ã© necessÃ¡rio pois agora Ã© HTML gerado por nÃ³s #}
                </div>
                {# Use the sanitized filename passed from the Flask route #}
                <a href="#" id="download-button" download="{{ download_filename }}">ğŸ“œ Baixar Pergaminho da Receita</a>
                <script>
                    // Dynamically set the download content
                    document.getElementById('download-button').onclick = function() {
                        // Use a variÃ¡vel com o conteÃºdo Markdown original para o download
                        var content = `{{ raw_markdown_content_for_download | safe }}`; // <--- Use a variÃ¡vel para download
                        var blob = new Blob([content], { type: 'text/plain' });
                        this.setAttribute('href', URL.createObjectURL(blob));
                        // The 'download' attribute is already set by Flask
                    };
                </script>

            {% else %}
                <div class="info-message"> {# Add info-message class #}
                    <p>Sua receita Ã©pica aparecerÃ¡ aqui apÃ³s a forja!</p>
                    <p>Prepare seus utensÃ­lios e acenda o fogo do dragÃ£o!</p>
                </div>
            {% endif %}
        </div>

        <hr>
        <div class="footer-custom"> {# Keep footer-custom class #}
            <p>&copy; 2025 BaÃº de Receitas. Todos os direitos reservados. Forjado com Magia e Aproveitamento.</p>
        </div>
    </div> {# Close main-container div #}
</body>
</html>